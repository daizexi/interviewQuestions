# this

## this到底起了哪些作用

### 假设一个场景，我们现在需要引用不同对象的中的属性。（只讨论普通函数）。

- 一种很自然的想法是在不同的上下文对象中调用对应的函数，这样函数的this将会自动绑定到这些对象上。
- 第二种不使用this的方法，则需要我们手动传入一个context参数。
- 因此我们可以看出，this可以以一种优雅的方式隐式绑定上下文对象，并且由于this可以在不同情况下应用不同规则指向不同的上下文对象，这样避免了当需求越来越复杂，使用的context越来越多的情况。

## 绑定规则

### 绑定规则的作用

- 绑定规则将决定this绑定在哪个上下文对象。

### 4条绑定规则

- 默认绑定

	- 生效条件

		- 当函数独立调用时将应用默认绑定规则，并且当不满足其他3条绑定规则时，也将应用默认绑定。

	- 作用

		- 将函数的this关键字绑定到全局对象（是全局对象而不是全局作用域）。

- 隐式绑定

	- 生效条件

		- 当函数调用时，函数被某一个上下文对象引用。

	- 作用

		- 将函数的this关键字绑定到引用函数的上下文对象。

- 显式绑定

	- 生效条件

		- 在调用函数时使用apply、call。

	- 作用

		- 将函数的this关键字绑定到提供的上下文对象。

	- 硬绑定

		- 生效条件

			- 在调用函数时使用bind。

		- 作用

			- 硬绑定是显式绑定的一个变种，用于解决this丢失的问题。

- new绑定

	- 生效条件

		- new绑定在使用new关键字调用函数时生效。

	- 作用

		- new绑定将把被当成构造函数调用的函数的this指向创建的新对象。

## 常见问题

### 隐式丢失

- 隐式丢失是指应用隐式绑定规则的函数的this关键字可能会丢失绑定对象。这时会应用默认规则。
- 常发生隐式丢失的情况

	- 使用函数别名调用函数。
	- 被当成是回调函数的函数。

- 解决方案

	- 使用函数别名导致隐式丢失的情况

		- 可以应用显式绑定解决。

	- 回调函数导致隐式丢失的情况

		- 使用硬绑定

### 被忽略的this

- 当把null、undefined作为绑定对象传入call、apply、bind时，将应用默认绑定规则。

## 绑定规则优先级

### new绑定优先级最高。

### 显示绑定或硬绑定。

### 隐式绑定。

### 默认绑定优先级最低。

## 箭头函数

### 回顾定义

- 箭头函数是ES6引入的由胖剪头定义的函数。

### 剪头函数的this

- 箭头函数的this不适用绑定规则，它的this关键字将从外层词法作用域继承，也就是当需要在箭头函数中使用this时，将应用词法作用域查找规则。实际上箭头函数和ES6之前的self = this作用是一致的。

